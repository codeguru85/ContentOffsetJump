Source code of [my answer on Stack Overflow](http://stackoverflow.com/a/19344402/1990236).
